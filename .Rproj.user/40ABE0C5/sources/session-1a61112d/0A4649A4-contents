# Ejercicio 2 

Trabajaremos con el conjunto de datos de 120 años de historia olímpica adquirido por Randi Griffin en Randi-Griffin y puesto a disposición en athlete_events.
Su tarea consiste en identificar los cinco deportes más importantes según el mayor número de medallas otorgadas en el año 2016, y luego realizar el siguiente análisis:

- Genere una tabla que indique el número de medallas concedidas en cada uno de los cinco principales deportes en 2016.
- Elabore una tabla que muestre la distribución de la edad de los ganadores de medallas en los cinco principales deportes en 2016.
- Identifique qué equipos nacionales ganaron el mayor número de medallas en los cinco principales deportes en 2016.
- Presente un resumen de la tendencia del peso de los atletas masculinos y femeninos ganadores en los cinco principales deportes en 2016.

## Eventos deportivos {.unnumbered}


```{r include=FALSE}
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown', 'kableExtra'
), 'packages.bib')

```

```{r results='hide', message=FALSE, warning=FALSE, }
library(tidyverse)
library(kableExtra)
library(ggplot2)
df <- read_csv('/Users/pctm/Desktop/Universidad/Sem 6/athlete_events.csv')
```

### Número de medallas concedidas en cada uno de los cinco principales deportes en 2016 {.unnumbered}
```{r}
df %>%
  filter(Year == 2016, !is.na(Medal)) %>%
  count(Sport, name = "medal_count") %>%
  arrange(desc(medal_count)) %>%
  slice_head(n = 5) -> top5

kable(top5, caption = "Numero de medallas por deporte en 2016")
```

```{r results='hide'}
top5_sports <- c("Athletics", "Swimming", "Rowing", "Football", "Hockey")
df_filtrado <- df %>%
  filter(Year == 2016, Sport %in% top5_sports, !is.na(Medal)) %>%
  select(Sport, Name, Age, Sex, Team, Medal, Weight)
```

### Distribución de la edad de los ganadores de medallas en los cinco principales deportes en 2016. {.unnumbered}
```{r}
df_filtrado %>%
  group_by(Sport) %>%
    summarise(
      n = n(),
      mean_age = mean(Age, na.rm = TRUE),
      median_age = median(Age, na.rm = TRUE),
      sd_age = sd(Age, na.rm = TRUE),
      IQR_age = IQR(Age, na.rm = TRUE),
      min_age = min(Age, na.rm = TRUE),
      max_age = max(Age, na.rm = TRUE),
      .groups = "drop"
    ) %>%
    arrange(desc(n)) -> dist_edad

kable(dist_edad, caption = "Tabla de distribución de edad")
```

### Equipos nacionales ganaron el mayor número de medallas en los cinco principales deportes en 2016. {.unnumbered}
``` {r}
df_filtrado %>%
  group_by(Team) %>%
  count(Team, name = "medal_count")  %>% 
  arrange(desc(medal_count)) %>% 
  head(n=5) -> top5_teams

kable(top5_teams, caption = "Top 5 equipos")
```

### Tendencia del peso de los atletas masculinos y femeninos  en los cinco principales deportes en 2016. {.unnumbered}
```{r warning=FALSE}
df_filtrado %>%
 group_by(Sex) %>% 
  summarise(
    mean_w = mean(Weight,na.rm = TRUE),
    median_w = median(Weight,na.rm = TRUE),
    min_w = min(Weight,na.rm = TRUE),
    max_w = max(Weight,na.rm = TRUE),
    sd_w = sd(Weight,na.rm = TRUE),
    IQR_w = IQR(Weight,na.rm = TRUE)) -> tendencia_w

kable(tendencia_w)

ggplot(df_filtrado, aes(x = factor(Sex), y = Weight, fill = Sex)) +
  geom_boxplot(outlier.shape = 21, alpha = 0.6) +
  geom_jitter(width = 0.12, alpha = 0.5, size = 1, color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +
  labs(title = "Distribución del peso por sexo",
       x = "Sexo",
       y = "Peso (kg)") +
  theme_minimal() +
  theme(legend.position = "none")

```
Para F (mujeres): la mediana está alrededor de 65 kg y la caja (IQR) es relativamente estrecha, lo que indica que la mayoría de las atletas ganadoras se agrupan cerca de ese valor; los bigotes son moderados y aparecen pocos outliers, aunque hay una cola derecha leve con algunos pesos atípicos. Para M (hombres): la mediana se ubica aproximadamente entre 75–80 kg, la caja es más ancha (mayor IQR) señalando mayor dispersión interna, y los bigotes junto con numerosos puntos atípicos muestran una cola derecha más pronunciada —es decir, hay más observaciones con pesos extremos. En ambos grupos se observan valores atípicos que podrían deberse a posiciones/disciplinas específica
