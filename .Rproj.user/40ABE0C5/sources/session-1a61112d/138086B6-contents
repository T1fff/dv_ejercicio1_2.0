--- 
title: "Ejercicios Corte 1"
author: "Tiffany Mendoza S."
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: rstudio/bookdown-demo
description: "Ejercicios R."
---

# Ejercicio 1

A partir del dataset df, el cual trata de los incendios forestales, realice las siguientes tareas:

- Filtrar los registros para incluir únicamente los incendios ocurridos en el estado de Idaho.

- Seleccionar únicamente las columnas YEAR_, CAUSE y TOTALACRES.

- Renombrar estas columnas con nombres más claros y descriptivos.

- Agrupar la información por CAUSE y YEAR_.

- Resumir el total de acres quemados para cada combinación de causa y año.

- Elaborar una visualización que muestre los resultados de manera clara.


## Incendios forestales {.unnumbered}


```{r include=FALSE}
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown', 'kableExtra'
), 'packages.bib')

```

```{r results='hide', message=FALSE, warning=FALSE, }
library(tidyverse)
library(kableExtra)
library(ggplot2)
df <- read_csv('/Users/pctm/Library/Mobile Documents/com~apple~CloudDocs/RDataSets/StudyArea.csv')
```

## Desarrollo {.unnumbered}


#### Filtrar los registros para incluir únicamente los incendios ocurridos en el estado de Idaho. Seleccionar y renombrar únicamente las columnas YEAR_, CAUSE y TOTALACRES. {.unnumbered}

```{r}
df %>% 
  filter(STATE == 'Idaho')  %>% 
  select(STARTYR=YEAR_, NATURE=CAUSE, ACRES=TOTALACRES) -> df_filtrado

head(df_filtrado)
```


### Agrupar la informacion por cause y year. {.unnumbered}

```{r message=FALSE, warning=FALSE}

df_filtrado %>% 
  group_by(NATURE, STARTYR) %>% 
  summarise(median_acres = mean(ACRES),
            ds_acres = sd(ACRES),
            mediana_acres = median(ACRES),
            RIC_acres = IQR(ACRES),
            min_acres = min(ACRES),
            max_acres = max(ACRES),
            q1_acres = quantile(ACRES)[2],
            q3_acres = quantile(ACRES)[4],
            total_acres = sum(ACRES)
            
            )-> showdf

kable(showdf, caption = "Agrupación por causa y año") %>% 
  column_spec(2, width = "20em") %>%
  scroll_box(width = "100%", height = "550px")


```
#### Gráficos {.unnumbered}
```{r}
ggplot(showdf, aes(x = factor(STARTYR), y = total_acres, fill = NATURE)) +
  geom_col() +
  labs(x="Año", y="Total acres", title="Total anual por causa") +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) +
  theme(axis.text.x = element_text(angle=45, hjust=1))

```

El gráfico de barras muestra que la variación anual en acres quemados es muy alta y está dominada por unos pocos años con incendios extremadamente grandes; en esos picos la mayor parte del área quemada corresponde a causas naturales, mientras que las causas humanas contribuyen de forma constante pero en magnitud mucho menor. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
ggplot(showdf, aes(x = factor(STARTYR), y = total_acres)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.8) +
  geom_jitter(width = 0.12, alpha = 0.12, size = 0.6, color = "steelblue") +
  stat_summary(fun = median, geom = "point", shape = 20, size = 2, color = "darkred") +
  labs(title = "Distribución de acres por incendio — boxplot por año",
       x = "Año", y = "Acres") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Este gráfico muestra, año a año, la distribución del tamaño de incendios (acres por incendio) mediante boxplots: la caja (IQR) marca la dispersión central, la línea roja indica la mediana, los bigotes extienden la variación típica y los puntos/extremos fuera de los bigotes son outliers / mega-fires. Visualmente se aprecia que en la mayoría de los años la mediana es baja (los puntos rojos están cerca de la base), mientras que los bigotes y los outliers alcanzan valores enormes en unos pocos años. Esto indica una distribución con cola larga a la derecha: muchos incendios pequeños y unos pocos incendios extremadamente grandes que empujan la escala.
